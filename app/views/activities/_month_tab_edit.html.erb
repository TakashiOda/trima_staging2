<div class="cp_tab">
  <% if !@activity.is_all_year_open %>
    <% if @activity.start_date <= Date.today.end_of_month %>
      <% first_month_date = Date.today %>
      <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),
        class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}" %>
      <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),
        class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% if @activity.end_date >= (Date.today >> 1).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),
          class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}" %>
        <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),
          class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
      <% if @activity.end_date >= (Date.today >> 2).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}" %>
        <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),
          class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
      <% if @activity.end_date >= (Date.today >> 3).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}" %>
        <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),
          class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
    <% else %>
      <% first_month_date = @activity.start_date %>
      <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),
        class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}" %>
      <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),
        class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% if @activity.end_date >= (@activity.start_date >> 1).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),
          class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}" %>
        <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
      <% if @activity.end_date >= (@activity.start_date >> 2).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),
          class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}" %>
        <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
      <% if @activity.end_date >= (@activity.start_date >> 3).beginning_of_month %>
        <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}" %>
        <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
      <% end %>
    <% end %>
  <% else %>
    <% first_month_date = Date.today %>
    <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}" %>
    <%=link_to "#{first_month_date.month}月", supplier_activity_edit_stocks_first_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_first_month' || action_name == 'stock_new_first_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
    <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}" %>
    <%=link_to "#{(first_month_date >> 1).month}月", supplier_activity_edit_stocks_next_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next_month' || action_name == 'stock_new_next_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
    <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}" %>
    <%=link_to "#{(first_month_date >> 2).month}月", supplier_activity_edit_stocks_next2_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next2_month' || action_name == 'stock_new_next2_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
    <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),class: "month_tab normal_link #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}" %>
    <%=link_to "#{(first_month_date >> 3).month}月", supplier_activity_edit_stocks_next3_month_path(current_supplier, @activity),class: "month_tab alert_link hidden #{'selected' if action_name == 'stock_edit_next3_month' || action_name == 'stock_new_next3_month'}", data: { confirm: '変更されています。保存せずに他の月に移動しますがよろしいですか?' } %>
  <% end %>
  <div class="form_big_title_questionIcon about_stock_term">
    <i class="far fa-question-circle"></i>
    <p id="fukidashi_about_stock_term">
      在庫は最大３ヶ月先の月末まで作成できます。
    </p>
  </div>
</div>

<style lang="scss">
  button.month_tab {
    padding: 10px 30px;
    height: 45px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    background: lightgray;
    color: gray;
    border-top-left-radius: 7px;
    border-top-right-radius: 8px;
    border: solid 0.5px #b9b9b9;
    border-bottom: none;
  }
  button.month_tab:focus {
    outline: 0;
  }
  button.month_tab:hover {
    outline: 0;
    cursor: pointer;
    opacity: 0.6;
  }
  a.month_tab.selected:hover {
    pointer-events: none !important;
    opacity: 1;
    cursor: pointer;
  }
  .form_big_title_questionIcon.about_stock_term {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 50px;
  }

  #fukidashi_about_stock_term {
    display: none;
    width: 200px;
    position: absolute;
    bottom: 40px;
    right: -87px;
    z-index: 100;
    padding: 16px;
    border-radius: 5px;
    background: #9e9e9eeb;
    color: #fff;
    font-weight: bold;
    font-size: 12px;
  }
  #fukidashi_about_stock_term:after {
    position: absolute;
    width: 0;
    height: 0;
    left: 100px;
    right: 100px;
    bottom: -20px;
    margin-left: 10px;
    border: solid transparent;
    border-color: rgba(51, 204, 153, 0);
    border-top-color: #9e9e9eeb;
    border-width: 10px;
    pointer-events: none;
    content: " ";
  }
  .form_big_title_questionIcon.about_stock_term svg:hover + #fukidashi_about_stock_term {
    display: block;
  }
  .form_big_title_questionIcon.about_stock_term svg {
    margin: 0;
    color: #0568b4;
    width: 22px !important;
    height: 22px !important;
  }
</style>
